# Relation Filtering

Earlier, we added a bunch of nice filters to our `DragonTreasure` resource. Let's also add some to `user` so we can show off some of the filtering *superpowers* of relations. The first thing we want to add, per usual, is  `ApiFilter` with `PropertyFilter::class`. This one isn't exactly a *filter*. It lets you select which fields you want to return in the response. All of this should look pretty familiar so far.

When we head over, refresh, and go to the `GET` collection endpoint... we see a new "properties[]" field here. If we wanted to, just as an example, we could say `username`... *or* we could return `username` *and* `dragonTreasures`. When we hit "Execute"... perfect! There they are - `username` and `dragonTreasures`. And because our `dragonTreasures` are *embedded*, we see the embedded objects. But it gets even *cooler*! We could have it return `username` and just the *name* of the `DragonTreasure`. Yep! To do that, copy this URL... and let's add a little `.jsonld` at the end. *Perfect*. And the syntax is a little complicated, but we can actually say `[dragonTreasures]`, followed by `[]=name`. And just like that, we're *just* returning the `name`. So right out of the box, this property filter allows us to reach across relationships.

Okay, let's do something *else*. Head back to `DragonTreasure.php`. Let's say that *sometimes* we want to be able to filter by the `$owner`. It would actually be really handy to see all of the `dragonTreasures` for a specific owner. To do that, above the `$owner` property, we'll once again add our `ApiFilter`, which is going to be a normal `SearchFilter::class`, followed by `strategy: 'exact'`. This will give us the exact user we're looking for.

Back over on the docs, if we open up the `GET` collection endpoint for treasures and hit "Try it out"... let's see... here we go - "owner". We can say something like `/api/users/4`, assuming that's actually a real user we have in our database, and... perfect! Here are the *five* treasures owned by that user.

But I want to take this a step further. I want to be able to find all of treasures that are owned by a user with a specific *username*. So instead of filtering on `owner`, we need to filter on `owner.username`. Check this out. When we want to filter an `owner`, we can put this a `ApiFilter` right above the `$owner` property. But since we want to filter on `owner.username`, we can't put that above a property because we don't have one for that. This is one of those cases where we need to put a filter above the class. And since we're not putting this above a property, we'll need to add a `properties` option set to an array. Inside, say `'owner.username'` and set that to the `partial` strategy.

I'll head back over and refresh. We know we have an owner whose username is "maug", so let's go back to our `GET` collection, and here in `owner.username`, we can search for "maug`... hit "Execute", and... that works! We can see all of the treasures owned by "maug". Pretty cool!

Next: We've reached our last topic - *Subresources* - which has seriously changed in API Platform 3.
